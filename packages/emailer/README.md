# @avenire/emailer - Email Sending Service

## Overview

The `@avenire/emailer` package was designed as the centralized email sending service for the Avenire monorepo. This README details its architecture, showcasing how it provided a streamlined way to send transactional and other types of emails. The package's design leveraged `nodemailer` for reliable email transport and integrated with `@react-email/components` for rendering HTML email templates created in the `@avenire/email` package. This serves as a case study in architecting a modular email sending system.

## Core Functionality Demonstrated

### `Emailer` Class Design

The `Emailer` class was designed to be responsible for configuring the email transport mechanism and sending emails.

-   **Constructor (`new Emailer()`):**
    The design intended for an `Emailer` instance to initialize a `nodemailer` transporter. For actual email sending functionality, this transporter would need to be configured with SMTP server details (such as host, port, username, and password), typically provided via environment variables in a live application. This approach demonstrates a centralized and consistent email sending configuration.

-   **`send(from: string, to: string[], subject: string, html: string, attachments?: Attachment[])` Method Design:**
    This asynchronous method was designed to send an email using the configured `nodemailer` transporter. Its parameters illustrate the necessary components of an email:
    -   `from`: The sender's email address.
    -   `to`: An array of recipient email addresses.
    -   `subject`: The subject line of the email.
    -   `html`: The HTML content of the email, intended to be generated by the `renderEmail` function.
    -   `attachments` (optional): An array of attachment objects compatible with `nodemailer`.

### `renderEmail(reactElement: React.ReactElement, options?: RenderOptions)` Function Design

This function demonstrates how a React element (typically an email template component from the `@avenire/email` package) could be converted into an HTML string. It utilized the `render` function from `@react-email/components` for this purpose.
-   `reactElement`: The React component representing the email template.
-   `options` (optional): Options for the rendering process, as defined by `@react-email/components`.

## Key Technologies & Design Choices

The architecture of `@avenire/emailer` showcases the use of specific technologies to achieve its goals:

-   **`nodemailer`**: Chosen as a powerful and flexible Node.js module for handling the complexities of email transport.
-   **`@react-email/components`**: Utilized for its utility (`render`) in converting React components into HTML email markup, allowing for modern development practices in email design.
-   **Integration with `@avenire/email`**: The design relied on the `@avenire/email` package to supply the actual React components for email templates (e.g., `WelcomeUserMessage`, `EmailVerificationMessage`), demonstrating a separation of concerns between template design and email sending logic.
-   **Shared TypeScript Configuration (`@avenire/typescript-config`)**: The use of a shared TypeScript configuration illustrates a commitment to code consistency and quality across the monorepo.

## Conceptual Design Pattern: Usage Example

The following conceptual snippet illustrates how another package (e.g., `@avenire/auth` for sending a welcome email) was intended to use the `@avenire/emailer` components:

```typescript
// Conceptual Design Pattern: Example of sending a welcome email
// import { Emailer, renderEmail } from "@avenire/emailer";
// import { WelcomeUserMessage } from "@avenire/email"; // Assuming a template from @avenire/email

async function sendWelcomeEmail_conceptual(userEmail: string, userName: string) {
  // In a live system, the Emailer constructor would use configured
  // SMTP details (host, port, auth) to initialize the transporter.
  // const emailer = new Emailer();

  // Render the React email template to an HTML string
  // const emailHtml = renderEmail(
  //   WelcomeUserMessage({ name: userName }) // Pass props to the template
  // );

  // The send method would then dispatch the email.
  // await emailer.send(
  //   "Avenire Platform <hello@avenire.com>",
  //   [userEmail],
  //   "Welcome to Avenire!",
  //   emailHtml
  // );
  // Actual error handling and logging would be implemented here.
}

// Conceptual invocation:
// sendWelcomeEmail_conceptual("newuser@example.com", "Jane Doe");
```
This example highlights the intended flow: instantiate an `Emailer`, render a template from `@avenire/email` to HTML using `renderEmail`, and then use the `emailer.send` method to dispatch it. The actual setup of SMTP transporters and detailed error handling would be specific to a deployment environment.

This README provides an overview of the `@avenire/emailer` package's design, illustrating its email sending architecture, choice of technologies, and integration patterns for educational and demonstrative purposes.
